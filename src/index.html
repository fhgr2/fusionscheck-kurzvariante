<!DOCTYPE html>
 
<html>
 
<head>
<title>Fusionscheck</title>
<meta charset="UTF-8" />

<!-- <link href="style.css" type="text/css" rel="stylesheet" /> -->
<style>

</style>
 
</head>
 
<body>
 
<div id="content_center" style="width: 490px; border: 1px solid black">
	<script src="d3.js"></script>
	<script src="radar-chart.js"></script>
	<!-- cut here ✂ ------------------------- -->
	<script src="//demo.tlab.ch/fusionscheck/d3.min.js"></script>
	<script src="//demo.tlab.ch/fusionscheck/radar-chart.min.js"></script>
	<div id="scoped-content"> 
		<style type="text/css" scoped> /* may not be scoped in certain browsers, but that should not matter since we won't override css from typo3 */
		
		.questiontext {
			width: 390px;
		}

		.questioncategory {
			font-weight: bold;
			color: #666;
		}

		table#questiontable {
			width: 100%;
		}

		#questiontable td {
			padding-bottom: 10px;
		}
		
		.fcinput {
			width: 40px;
		}
		
		/* radar chart options */
	.radar-chart .level {
		stroke: grey;
		stroke-width: 0.5;
	}

	.radar-chart .axis line {
		stroke: grey;
		stroke-width: 1;
	}

	.radar-chart .axis .legend {
		font-family: sans-serif;
		font-size: 10px;
	}

	.radar-chart .axis .legend.top {
		dy:1em;
	}

	.radar-chart .axis .legend.left {
		text-anchor: start;
	}

	.radar-chart .axis .legend.middle {
		text-anchor: middle;
	}

	.radar-chart .axis .legend.right {
		text-anchor: end;
	}

	.radar-chart .tooltip {
		font-family: sans-serif;
		font-size: 13px;
		transition: opacity 200ms;
		opacity: 0;
	}

	.radar-chart .tooltip.visible {
		opacity: 1;
	}

	/* area transition when hovering */
	.radar-chart .area {
		stroke-width: 2;
		fill-opacity: 0.5;
	}

	.radar-chart.focus .area {
		fill-opacity: 0.1;
	}

	.radar-chart.focus .area.focused {
		fill-opacity: 0.7;
	}

	.radar-chart .circle {
		fill-opacity: 0.9;
	}

	/* radar chart transitions */
	.radar-chart .area, .radar-chart .circle {
		transition: opacity 300ms, fill-opacity 200ms;
		opacity: 1;
	}
	.radar-chart .d3-enter, .radar-chart .d3-exit {
		opacity: 0;
	}
		</style>
		<table id="questiontable">
			</tr>
				<td><div id="category1" class="questioncategory">Finanzielle Leistungsfähigkeit</div><div class="questiontext">Wie hoch ist der Selbstfinanzierungsanteil in Ihrer Gemeinde gemäss Statistik der laufenden Gemeinderechnung? </div></td>
				<td><input class="fcinput" id="input1" type="text" size="3"/> %</td>
			</tr>
			<tr>
				<td><div id="category2" class="questioncategory">Professionalität</div><div class="questiontext">Wie viele Stunden pro Woche ist der Schalter des Gemeindehauses geöffnet? (Zählen Sie die Stunden vor 08:00 Uhr, zwischen 12:00 und 14:00 und diejenigen nach 17:00 Uhr doppelt.)</div></td>
				<td><input class="fcinput" id="input2" type="text" size="3"/> h</td>
			</tr>
			<tr>
				<td><div id="category3" class="questioncategory">Aussenwirkung</div><div class="questiontext">Wie gross ist der Einfluss Ihrer Gemeinde auf die kantonale Politik? (0 = kein Einfluss bis 4 = grosser Einfluss)</div></td>
				<td><input class="fcinput" id="input3" type="text" size="3"/>  Pkte</td>
			</tr>
			<tr>
				<td><div id="category4" class="questioncategory">Standortattraktivität</div><div class="questiontext">Wie hoch sind die jährlichen Steuererträge der natürlichen Personen pro Einwohner?</div></td>
				<td><input class="fcinput" id="input4" type="text" size="3"/> CHF</td>
			</tr>
			<tr>
				<td><div id="category5" class="questioncategory">Mitwirkungsrechte</div><div class="questiontext">Wie hoch ist der Anteil an Stimmberechtigten, die für die Einreichung einer Initiative benötigt sind (Quorum)?</div></td>
				<td><input class="fcinput" id="input5" type="text" size="3"/> %</td>
			</tr>
			<tr>
				<td><div id="category6" class="questioncategory">Partizipation</div><div class="questiontext">Wie hoch ist die durchschnittliche Stimmbeteiligung für kommunale Angelegenheiten?</div></td>
				<td><input class="fcinput" id="input6" type="text" size="3"/> %</td>
			</tr>
			<tr>
				<td><div id="category7" class="questioncategory">Filz / "Vetterliwirtschaft"</div><div class="questiontext">Wie viele Offerten haben Sie im Durchschnitt pro Submissionsverfahren eingeholt?</div></td>
				<td><input class="fcinput" id="input7" type="text" size="3"/> Off.</td>
			</tr>
			<tr>
				<td><div id="category8" class="questioncategory">Bürgernähe</div><div class="questiontext">Wie hoch ist der Anteil der angenommenen Vorlagen des Gemeindevorstandes (an Gemeindeversammlung und/oder Urnengemeinde)?</div></td>
				<td><input class="fcinput" id="input8" type="text" size="3"/> %</td>
			</tr>
			<tr>
				<td><div id="category9" class="questioncategory">Soziale Integration</div><div class="questiontext">Wie viele  Gesuche zur Durchführung einer Veranstaltung von Vereinen wurden im letzten ganzen Jahr eingereicht?</div></td>
				<td><input class="fcinput" id="input9" type="text" size="3"/> Ges.</td>
			</tr>
			<tr>
				<td><div id="category10" class="questioncategory">Identifikation mit Gemeinde</div><div class="questiontext">Wie hoch ist der Anteil an Wochenaufenthaltern in Ihrer Gemeinde? (Anzahl Wochenaufenthalter / ständige Wohnbevölkerung (STATPOP))</div></td>
				<td><input class="fcinput" id="input10" type="text" size="3"/> %</td>
			</tr>		
		</table>
	
		<div id="body">
			<div id="chart"></div>
		</div>
	
	</div>
	
	<script>
	// mostly taken from http://bl.ocks.org/nbremer/6506614
	var w = 490;
	var h = 490;

	var colorscale = d3.scale.category10();

	//Legend titles
	var LegendOptions = ['Smartphone','Tablet'];

	//Data
	var d = [
				[
					{value:0.59},
					{value:0.56},
					{value:0.42},
					{value:0.34},
					{value:0.98},
					{value:0.14},
					{value:0.81},
					{value:0.05},
					{value:0.87},
					{value:0.12},
				],[
					{value:0.48},
					{value:0.41},
					{value:0.27},
					{value:0.28},
					{value:0.96},
					{value:0.29},
					{value:0.11},
					{value:0.84},
					{value:0.05},
					{value:0.19},
				]
			];
	
	// Read axis titles from html and put them into the json
	for (var i=1; i<=10; i++) {
		d[0][i-1].axis = document.getElementById("category"+i).innerHTML;
		d[1][i-1].axis = document.getElementById("category"+i).innerHTML;
	}

	//Options for the Radar chart, other than default
	var mycfg = {
		w: w,
		h: h,
		maxValue: 1,
		levels: 5,
		ExtraWidthX: 300
	}

	//Call function to draw the Radar chart
	//Will expect that data is in %'s
	RadarChart.draw("#chart", d, mycfg);

	////////////////////////////////////////////
	/////////// Initiate legend ////////////////
	////////////////////////////////////////////

	var svg = d3.select('#body')
		.selectAll('svg')
		.append('svg')
		.attr("width", w+300)
		.attr("height", h)
	
	//Create the title for the legend
	var text = svg.append("text")
		.attr("class", "title")
		.attr('transform', 'translate(90,0)') 
		.attr("x", w - 70)
		.attr("y", 10)
		.attr("font-size", "12px")
		.attr("fill", "#404040")
		.text("What % of owners use a specific service in a week");
			
	//Initiate Legend	
	var legend = svg.append("g")
		.attr("class", "legend")
		.attr("height", 100)
		.attr("width", 200)
		.attr('transform', 'translate(90,20)') 
		;
		
	//Create colour squares
	legend.selectAll('rect')
		.data(LegendOptions)
		.enter()
		.append("rect")
		.attr("x", w - 65)
		.attr("y", function(d, i){ return i * 20;})
		.attr("width", 10)
		.attr("height", 10)
		.style("fill", function(d, i){ return colorscale(i);})
		;
		
	//Create text next to squares
	legend.selectAll('text')
		.data(LegendOptions)
		.enter()
		.append("text")
		.attr("x", w - 52)
		.attr("y", function(d, i){ return i * 20 + 9;})
		.attr("font-size", "11px")
		.attr("fill", "#737373")
		.text(function(d) { return d; })
		;
	</script>
	<!-- cut here ✂ ------------------------- -->
</div>
</body>
</html>